# 子查询

## 子查询出现位置

### 子查询出现在目标列位置
当子查询出现在目标列位置的时候，这种查询只能是标量子查询。也就是说子查询返回的结果只能是一个元组的一个属性。否则，数据库会返回错误信息。

### 子查询出现在FROM字句的位置
简单来说，`FROM` 子句部分的子查询只能是非相关子查询，非相关子查询出现在FROM子句中可以上拉到父层，在多表连接时统一考虑连接代价然后进行优化。
```sql
-- ×
select * from t1, (select *from t2 where t1.k1 = t2.k2);
错误代码： 1054
Unknown column 't1.k1' in 'where clause'

-- √
select * from t1, (select *from t2) where t1.k1 = t2.k2;
```

### 子查询出现在WHERE子句当中
出现在 `WHERE` 子句中的子查询，是一个条件表达式的一部分，而表达式可以分为操作符和操作数；根据参与运算的操作符的不同类型，操作符也不尽相同。如INT型有 `>`, `<`, `=`, `<>`等操作。这时对子查询有一定的要求（如 `INT` 型的等值操作，要求子查询必须是标量子查询）。另外子查询出现在WHERE字句中的格式，也有用谓词指定的一些操作，如`IN`，`BETWEEN`，`EXISTS`等。

### `JOIN` / `ON` 字句位置
JOIN/ON子句可以分为两部分，一是JOIN块，类似于FROM子句。二是ON子句块，类似于WHERE子句。这两部分都可以出现子查询。子查询的处理方式同FROM子句和和WHERE子句。



// todo 没看完 https://blog.csdn.net/wmq880204/article/details/52787957